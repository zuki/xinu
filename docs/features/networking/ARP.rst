ARP
===

:doc:`ネットワークサブシステム <index>` の一部として、XINUはプロトコル
アドレス（IPv4アドレスなど）をハードウェアアドレス（MACアドレスなど）に
変換する **ARP** (**Address Resolution Protocol**) をサポートしています。


ARPデーモン
--------------

ARPデーモンは起動時に自動的に実行され、ARPパケットの着信を待ちます。
着信パケットは :source:`netRecv() <network/net/netRecv.c>` で
フィルタリングされ、ARPリクエスト/リプライは
:source:`ARPデーモン <network/arp/arpDaemon.c>` に送られます。

パケット送信時のARPの使用
-------------------------------

:source:`netSend() <network/net/netSend.c>` の呼び出し側は宛先
コンピュータのハードウェアアドレスである  ``hwaddr`` を指定する必要は
なく、このパラメータを  ``NULL`` にしておくことができます。
そのような場合、:source:`arpLookup() <network/arp/arpLookup.c>` が
呼び出され、宛先プロトコルアドレスとハードウェアアドレスの対応付けが
試みられます。これにはまずARPテーブルが検索されますが、該当するエントリが
見つからない場合はARPリクエストが送信されます。後者の場合、呼び出し側の
スレッドは、ARPデーモンが対応する応答を受信して起床させるか、指定された
タイムアウトが発生するまでスリープさせられます。

シェルコマンド
--------------

ARPテーブルをプリントするには :doc:`XINUシェル </features/Shell>`
から **arp** コマンドを実行します。

.. code-block:: none

    xsh@supervoc$ arp

    Address                 HWaddress               Interface
    192.168.6.10            52:54:03:02:B1:06       ETH0
    192.168.6.101           00:16:B6:28:7D:4F       ETH0
    192.168.6.130           00:25:9C:3A:87:53       ETH0

現在のところ、マニュアルでAPRテーブルのエントリを追加・削除したり、
ARPテーブルをクリアしたりする方法はありません。

参考資料
---------

* :rfc:`826`
